features:
  - name: api
    scopes:
      - match: module
        prefix: "{{snake .Module.Name}}/"
        documents:
          - source: "api/api.py.tpl"
            target: "api.py"
  - name: scaffold
    scopes:
      - match: system
        documents:
          - source: requirements.txt
            target: requirements.txt
            raw: true
          - source: README.md
            target: README.md
            raw: true
      - match: interface
        prefix: "{{snake .Module.Name}}/"
        documents:
          - source: "scaffold/__init__.py.tpl"
            target: "__init__.py"
          - source: "scaffold/interface.py.tpl"
            target: "{{snake .Interface.Name}}.py"

  - name: http
    scopes:
      - match: system
        documents:
          - source: "http/server.py.tpl"
            target: "http/server.py"
      - match: module
        prefix: "{{path .Module.Name}}/"
        documents:
          - source: "http/__init__.py"
            target: "http/__init__.py"
            raw: true
          - source: "http/client.py.tpl"
            target: "http/client.py"
          - source: "http/routes.py.tpl"
            target: "http/routes.py"
          - source: "http/shared.py.tpl"
            target: "http/shared.py"
  - name: olink
    requires: [api, scaffold]
    scopes:
      - match: system
        documents:
          - source: "olink/OLINK_README.md"
            target: "OLINK_README.md"
            raw: true
          - source: "olink/server.py.tpl"
            target: "olink_server.py"
      - match: module
        prefix: "{{snake .Module.Name}}/"
        documents:
          - source: "olink/__init__.py"
            target: "olink/__init__.py"
            raw: true
          - source: "olink/client.py.tpl"
            target: "olink/client.py"
